migration:
  options:
    install_command: odoo
  versions:
    - version: 10.0.0
      operations:
        pre:
          - anthem songs.install.pre::main
        post:
          - anthem songs.install.company::main
          # Specific case for cloud platform: on our platform, AWS_ACCESS_KEY_ID will be defined
          # so we know we have to install and configure the platform addons.
          # Won't be done on the image delivered to BSO.
          - bash -c '[ -z "$AWS_ACCESS_KEY_ID" ] && exit 0 || gosu odoo odoo --stop-after-init --workers=0 --log-level=warn -i cloud_platform'
          - bash -c '[ -z "$AWS_ACCESS_KEY_ID" ] && exit 0 || anthem odoo.addons.cloud_platform.songs::install_exoscale'
      modes:
        full:
          operations:
            post:
              - anthem songs.install.data_full::main
        demo:
          operations:
            post:
              - anthem songs.install.data_demo::main
      addons:
        upgrade:
          - account
          - analytic
          - auth_ldap
          - base_technical_features
          - queue_job
          - connector
          - connector_jira
          - server_env_connector_jira
          - crm
          - document
          - hr
          - l10n_fr
          - l10n_lu
          - l10n_uk
          - l10n_us
          - purchase
          - stock
          - website_contract

# TODO v10: replace this file w/ `migration.todo.yml`
